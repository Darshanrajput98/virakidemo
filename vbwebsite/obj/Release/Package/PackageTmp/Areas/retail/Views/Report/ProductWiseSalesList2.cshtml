@model List<vb.Data.RetProductWiseSalesList>
@{
    ViewBag.Title = "ProductWiseSalesList2";
    Layout = "~/Areas/retail/Views/Shared/_retaillayout.cshtml";
}

<div class="box">
    @*<div class="box-header text-center">
            <h3 class="box-title">Area List</h3>
        </div>*@
    <!-- /.box-header -->
    <div class="box-body table-scrollable1">
        <table id="ListDataTableNoPaging1" class="table table-bordered table-striped">
            <thead>
                <tr>
                    <td colspan="5" align="right">
                        <button type="button" id="btnexport" class="btn btn-info">Export To Excel</button>
                    </td>
                </tr>
                <tr>
                    <th class="nosort">Sr.No</th>
                    <th class="nosort">Category Name</th>
                    <th class="nosort">Product</th>
                    <th class="nosort">Quantity</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Count() > 0)
                {
                    foreach (var item in Model)
                    {
                        <tr>
                            <td id="row">
                                @item.SrNo
                            </td>
                            <td>
                                @item.CategoryName
                            </td>
                            <td>
                                @item.ProductName
                            </td>
                            <td>
                                @item.Quantity
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
    <!-- /.box-body -->
</div>

<script src="~/Scripts/jquery-1.10.2.js"></script>
<script>
    $("#btnexport").click(function () {
        debugger;

        var StartDatestr = window.location.search.split('=')[1];
        var arr1 = StartDatestr.split('&');
        var StartDate = arr1[0];

        var EndDatestr = window.location.search.split('=')[2];
        var arr2 = EndDatestr.split('&');
        var EndDate = arr2[0];

        var CustomerIDstr = window.location.search.split('=')[3];
        var arr3 = CustomerIDstr.split('&');
        var CustomerID = arr3[0];

        var AreaIDstr = window.location.search.split('=')[4];
        var arr4 = AreaIDstr.split('&');
        var AreaID = arr4[0];

        var ProductCategoryIDstr = window.location.search.split('=')[5];
        var arr5 = ProductCategoryIDstr.split('&');
        var ProductCategoryID = arr5[0];

        var ProductQtyIDstr = window.location.search.split('=')[6];
        var arr6 = ProductQtyIDstr.split('&');
        var ProductQtyID = arr6[0];

        var UserIDstr = window.location.search.split('=')[7];
        var arr7 = UserIDstr.split('&');
        var UserID = arr7[0];

        var url = '@Url.Action("ExportExcelZeroProductReport", "Report", new { StartDate = "__StartDate__", EndDate = "__EndDate__", CustomerID = "__CustomerID__", AreaID = "__AreaID__", ProductCategoryID = "__ProductCategoryID__", ProductQtyID = "__ProductQtyID__", UserID = "__UserID__" })';
        url = url.replace(/amp;/g, '');
        window.location.href = url.replace('__StartDate__', StartDate).replace('__EndDate__', EndDate).replace('__CustomerID__', CustomerID).replace('__AreaID__', AreaID).replace('__ProductCategoryID__', ProductCategoryID).replace('__ProductQtyID__', ProductQtyID).replace('__UserID__', UserID);
    });
</script>


